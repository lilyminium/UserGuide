{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Non-linear dimension reduction to diffusion maps\n",
    "\n",
    "Here we reduce the dimensions of a trajectory into a diffusion map.\n",
    "\n",
    "**Last updated:** February 2020\n",
    "\n",
    "**Minimum version of MDAnalysis:** 0.17.0\n",
    "\n",
    "**Packages required:**\n",
    "    \n",
    "* MDAnalysis (<a data-cite=\"michaud-agrawal_mdanalysis_2011\" href=\"https://doi.org/10.1002/jcc.21787\">Michaud-Agrawal *et al.*, 2011</a>, <a data-cite=\"gowers_mdanalysis_2016\" href=\"https://doi.org/10.25080/Majora-629e541a-00e\">Gowers *et al.*, 2016</a>)\n",
    "* MDAnalysisTests\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import MDAnalysis as mda\n",
    "from MDAnalysis.tests.datafiles import PSF, DCD\n",
    "from MDAnalysis.analysis import diffusionmap\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Loading files\n",
    "\n",
    "The test files we will be working with here feature adenylate kinase (AdK), a phosophotransferase enzyme. (<a data-cite=\"beckstein_zipping_2009\" href=\"https://doi.org/10.1016/j.jmb.2009.09.009\">Beckstein *et al.*, 2009</a>) The trajectory ``DCD`` samples a transition from a closed to an open conformation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "u = mda.Universe(PSF, DCD)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<MDAnalysis.analysis.diffusionmap.DiffusionMap at 0x120b43c50>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dmap = diffusionmap.DiffusionMap(u, select='backbone', epsilon=2)\n",
    "dmap.run()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x120b42410>]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots()\n",
    "ax.plot(dmap.eigenvalues[:10])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "fit = dmap.transform(3, time=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-9.47948061e-02, -7.59495111e-02, -5.47077199e-02],\n",
       "       [-1.66067940e-01, -1.32017243e-01, -9.44092770e-02],\n",
       "       [-1.99960405e-01, -1.54474739e-01, -1.07424677e-01],\n",
       "       [ 2.28814609e-01,  1.68694363e-01,  1.11460122e-01],\n",
       "       [ 2.50383632e-01,  1.71873083e-01,  1.03406697e-01],\n",
       "       [-2.50199664e-01, -1.56912015e-01, -8.12446062e-02],\n",
       "       [ 2.44546758e-01,  1.36780876e-01,  5.49902250e-02],\n",
       "       [ 2.46111139e-01,  1.16860780e-01,  2.68157499e-02],\n",
       "       [-2.12683519e-01, -7.53727228e-02,  7.31232455e-03],\n",
       "       [ 1.47584845e-01,  2.33288497e-02, -3.50970127e-02],\n",
       "       [ 1.18955077e-01, -2.65221496e-02, -7.43193445e-02],\n",
       "       [ 1.41126237e-01, -9.71074476e-02, -1.56091700e-01],\n",
       "       [-6.89273524e-02,  1.05297877e-01,  1.34996812e-01],\n",
       "       [-1.43198826e-05, -1.73408006e-01, -1.55402531e-01],\n",
       "       [ 3.59762508e-02,  1.66972269e-01,  1.08416113e-01],\n",
       "       [ 8.47486607e-02,  2.50379589e-01,  1.19461783e-01],\n",
       "       [ 3.13380103e-02,  6.66117529e-02,  1.88484093e-02],\n",
       "       [-7.38321094e-02, -1.39450412e-01, -2.55694742e-02],\n",
       "       [-1.03194968e-01, -1.63724641e-01,  6.29499299e-03],\n",
       "       [-1.16315888e-01, -1.70583023e-01,  2.35271461e-02],\n",
       "       [-1.07439129e-01, -1.45842601e-01,  3.27656236e-02],\n",
       "       [ 2.55954863e-01,  3.14832059e-01, -1.00934081e-01],\n",
       "       [-1.47043061e-01, -1.43761282e-01,  7.32981735e-02],\n",
       "       [-2.72167337e-01, -1.03771510e-01,  1.44889767e-01],\n",
       "       [ 8.11248843e-02,  4.71907842e-02, -4.42338562e-02],\n",
       "       [ 1.14970812e-01,  4.48913132e-02, -6.02716372e-02],\n",
       "       [-5.46730552e-01,  1.44368246e-01,  2.32597575e-01],\n",
       "       [ 9.74706358e-03, -1.61391559e-02, -2.15702305e-03],\n",
       "       [-1.31399475e-04,  1.93256734e-03, -1.58761185e-04],\n",
       "       [ 1.89791970e-01, -1.76783408e-01, -2.50958800e-03],\n",
       "       [-4.43689174e-01,  4.16017769e-01, -2.09604206e-01],\n",
       "       [-2.37163912e-02,  1.93014900e-02, -8.79229070e-03],\n",
       "       [ 3.82313379e-02, -3.97909864e-02,  2.21470779e-02],\n",
       "       [-7.72017080e-04, -1.68932767e-05,  6.25253580e-04],\n",
       "       [ 1.61290126e-01, -1.21535769e-01,  2.21942438e-01],\n",
       "       [ 8.01044835e-04,  2.02126974e-03,  9.33094517e-04],\n",
       "       [ 1.17906380e-02, -2.39567459e-02,  1.69532806e-02],\n",
       "       [-3.30954818e-02,  4.95644453e-02, -3.75452060e-02],\n",
       "       [ 1.16565287e-01, -7.76668246e-02,  8.65616354e-02],\n",
       "       [ 1.08387615e-03,  1.76083699e-03, -1.60421941e-03],\n",
       "       [ 6.70152765e-03, -9.03205822e-04, -8.75407908e-03],\n",
       "       [-2.79929791e-02,  6.98110542e-03,  3.14133442e-02],\n",
       "       [ 9.13526407e-03, -3.37966741e-03, -7.04527830e-03],\n",
       "       [-9.72552263e-07, -4.13718852e-07,  2.49853587e-07],\n",
       "       [ 2.70923579e-02, -1.21270364e-02, -2.19419110e-02],\n",
       "       [ 2.39217762e-02, -1.25613140e-02, -8.03452194e-03],\n",
       "       [-2.30381829e-02,  1.10092141e-02,  1.28731135e-02],\n",
       "       [-4.99698304e-03,  2.02193956e-03, -8.54140367e-06],\n",
       "       [-1.71850866e-03,  4.99354002e-05,  2.82857167e-03],\n",
       "       [-6.50397241e-03,  2.55586474e-02, -3.75881983e-02],\n",
       "       [-2.14493707e-03,  4.33260261e-03, -4.37065841e-03],\n",
       "       [ 2.19407118e-07,  1.91394699e-07,  7.56127335e-07],\n",
       "       [-1.14788701e-06, -2.48754737e-06,  4.60355403e-06],\n",
       "       [-5.49278578e-03,  8.39950776e-03, -4.80694122e-03],\n",
       "       [ 8.03466875e-03, -1.19651203e-02,  2.66252362e-03],\n",
       "       [ 3.09380952e-06, -5.80713373e-07, -7.77521967e-07],\n",
       "       [-2.77290966e-03,  3.95002406e-04,  1.58232807e-03],\n",
       "       [ 2.58493046e-02, -1.55236627e-02,  1.53359468e-03],\n",
       "       [-3.49752750e-06, -6.44252798e-07, -6.22808742e-06],\n",
       "       [-8.78061648e-06,  4.95952820e-06,  4.08775010e-06],\n",
       "       [-2.10067190e-03,  1.02726860e-03, -7.01308057e-04],\n",
       "       [-7.99850042e-03,  5.85194889e-03, -3.01477932e-04],\n",
       "       [ 5.65573297e-06, -2.21400873e-06, -6.86679586e-06],\n",
       "       [ 7.08874479e-06, -1.66896333e-05,  6.02414153e-06],\n",
       "       [ 3.98301754e-03, -4.61878116e-03,  1.59599234e-03],\n",
       "       [-2.41115509e-02,  2.86552782e-02, -9.51109260e-03],\n",
       "       [-3.19459626e-05,  1.51399642e-05,  3.38008133e-05],\n",
       "       [ 2.71833869e-06,  9.46021321e-07, -3.79718669e-06],\n",
       "       [ 1.10623369e-05, -1.75377513e-07, -2.36729959e-05],\n",
       "       [ 4.12681589e-03, -3.84581601e-03,  8.97311809e-04],\n",
       "       [-1.20313636e-02,  1.31762663e-02, -3.80631582e-03],\n",
       "       [-4.79412738e-05,  4.09524741e-05,  1.25997796e-05],\n",
       "       [-4.40194973e-03,  2.52114326e-03,  8.39702721e-04],\n",
       "       [ 6.62970321e-03,  3.42223276e-03, -8.02623547e-03],\n",
       "       [ 6.22809965e-04,  1.21933389e-03, -1.62077070e-03],\n",
       "       [ 3.95959824e-05, -3.40192962e-05,  8.55580766e-06],\n",
       "       [-3.20808587e-04, -7.71223894e-03,  7.73400897e-03],\n",
       "       [ 3.60022861e-03, -6.97379275e-03,  4.78001377e-03],\n",
       "       [-5.25353641e-03,  8.77381796e-03, -4.85587287e-04],\n",
       "       [-4.71610600e-05,  5.25300689e-05,  2.61333613e-05],\n",
       "       [ 2.62492457e-04, -2.51552186e-04, -1.49977065e-04],\n",
       "       [ 9.87888449e-04, -1.77224624e-03, -4.33544331e-04],\n",
       "       [ 1.36401664e-04, -1.42315576e-04, -1.26919610e-04],\n",
       "       [-2.20947565e-03,  4.69544036e-03, -1.98163950e-03],\n",
       "       [ 1.05068341e-05, -5.56791274e-05,  1.81966652e-04],\n",
       "       [-1.53132312e-05, -3.47968344e-05, -1.25551781e-04],\n",
       "       [-2.04423085e-04,  1.41378514e-04,  7.99721775e-04],\n",
       "       [-7.45630582e-04,  7.46050192e-04, -1.64624588e-03],\n",
       "       [ 9.13827319e-04, -1.02946871e-03,  5.75442281e-04],\n",
       "       [ 1.01115638e-03, -1.15363557e-03, -2.42301224e-04],\n",
       "       [-9.28550536e-05, -1.92127567e-04,  9.40980602e-05],\n",
       "       [-6.25782744e-05,  4.64226348e-05,  1.97465650e-04],\n",
       "       [ 9.34697307e-04, -2.69385337e-03,  1.14502838e-03],\n",
       "       [-2.00214394e-04, -3.20397461e-03,  3.49433959e-04],\n",
       "       [-2.54495318e-04,  4.52068424e-04, -2.34791504e-04],\n",
       "       [-6.24183142e-03,  1.63358361e-02, -7.39439916e-03],\n",
       "       [-7.01684675e-04, -1.46898631e-03, -4.03102911e-04],\n",
       "       [-4.15202159e-04,  3.81447425e-03, -1.08760435e-03]])"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "Missing parentheses in call to 'print'. Did you mean print(\"yes\")? (<ipython-input-10-dbc51e0c5b49>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;36m  File \u001b[0;32m\"<ipython-input-10-dbc51e0c5b49>\"\u001b[0;36m, line \u001b[0;32m1\u001b[0m\n\u001b[0;31m    print \"yes\"\u001b[0m\n\u001b[0m              ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m Missing parentheses in call to 'print'. Did you mean print(\"yes\")?\n"
     ]
    }
   ],
   "source": [
    "print \"yes\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python (mda)",
   "language": "python",
   "name": "mda"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": false,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
