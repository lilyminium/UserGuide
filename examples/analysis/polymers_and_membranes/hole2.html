

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Analysing pore dimensions with HOLE &mdash; MDAnalysis User Guide  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/mdanalysis-logo.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Volumetric analyses" href="../volumetric/README.html" />
    <link rel="prev" title="Analysing pore dimensions (deprecated)" href="hole.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../../index.html">
          

          
            
            <img src="../../../_static/user_guide.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently asked questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../README.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../constructing_universe.html">Constructing, modifying, and adding to a Universe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../transformations/README.html">Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parmed_sim.html">Using ParmEd with MDAnalysis and OpenMM to simulate a selection of atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alignment_and_rms/README.html">Alignments and RMS fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../distances_and_contacts/README.html">Distances and contacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trajectory_similarity/README.html">Trajectory similarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hydrogen_bonding/README.html">Hydrogen bonding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../structure/README.html">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reduced_dimensions/README.html">Dimension reduction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="README.html">Polymers and membranes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="polymer.html">Determining the persistence length of a polymer</a></li>
<li class="toctree-l3"><a class="reference internal" href="hole.html">Analysing pore dimensions (deprecated)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Analysing pore dimensions with HOLE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Using-HOLE-with-a-PDB-file">Using HOLE with a PDB file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Using-HOLE-with-a-trajectory">Using HOLE with a trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Ordering-HOLE-profiles-with-an-order-parameter">Ordering HOLE profiles with an order parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Deleting-HOLE-files">Deleting HOLE files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../volumetric/README.html">Volumetric analyses</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Data structures</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../universe.html">Universe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../atomgroup.html">AtomGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../groups_of_atoms.html">Groups of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../selections.html">Atom selection language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../topology_system.html">The topology system</a></li>
</ul>
<p class="caption"><span class="caption-text">Trajectories</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectories/trajectories.html">Trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectories/slicing_trajectories.html">Slicing trajectories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectories/transformations.html">On-the-fly transformations</a></li>
</ul>
<p class="caption"><span class="caption-text">Input/output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../reading_and_writing.html">Reading and writing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/index.html">Format overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/guessing.html">Guessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/auxiliary.html">Auxiliary files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/selection_exporters.html">Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../formats/format_reference.html">Format reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#alignments-and-rms-fitting">Alignments and RMS fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#distances-and-contacts">Distances and contacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#trajectory-similarity">Trajectory similarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#hydrogen-bonding">Hydrogen bonding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#volumetric-analyses">Volumetric analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#dimension-reduction">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html#polymers-and-membranes">Polymers and membranes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../custom_trajectory_analysis.html">Writing your own trajectory analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../standard_selections.html">Standard residues in MDAnalysis selections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_topology.html">Advanced topology concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets.html">Example data</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing to MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing_code.html">Contributing to the main codebase</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing_docs.html">Contributing to the user guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../preparing_releases_and_hotfixes.html">Preparing a release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_imports.html">Module imports in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../testing.html">Tests in MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MDAnalysis User Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../README.html">Examples</a> &raquo;</li>
        
          <li><a href="README.html">Polymers and membranes</a> &raquo;</li>
        
      <li>Analysing pore dimensions with HOLE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/examples/analysis/polymers_and_membranes/hole2.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<script src='http://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js'></script>
<script>require=requirejs;</script><div class="section" id="Analysing-pore-dimensions-with-HOLE">
<h1>Analysing pore dimensions with HOLE<a class="headerlink" href="#Analysing-pore-dimensions-with-HOLE" title="Permalink to this headline">¶</a></h1>
<p>Here we use <code class="docutils literal notranslate"><span class="pre">HOLE</span></code> to analyse pore dimensions in a membrane.</p>
<p><strong>Last executed:</strong> Feb 20, 2020 with MDAnalysis 0.20.2-dev0</p>
<p><strong>Last updated:</strong> February 2020</p>
<p><strong>Minimum version of MDAnalysis:</strong> 1.0</p>
<p><strong>Packages required:</strong></p>
<ul class="simple">
<li><p>MDAnalysis (<a class="bibtex reference internal" href="../../../references.html#michaud-agrawal-mdanalysis-2011" id="id1">[MADWB11]</a>, <a class="bibtex reference internal" href="../../../references.html#gowers-mdanalysis-2016" id="id2">[GLB+16]</a>)</p></li>
<li><p>MDAnalysisTests</p></li>
<li><p><a class="reference external" href="http://www.holeprogram.org">HOLE</a></p></li>
<li><p>matplotlib</p></li>
<li><p>numpy</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>The classes in <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hole2</span></code> are wrappers around the HOLE program. Please cite (<a class="bibtex reference internal" href="../../../references.html#smart-pore-1993" id="id3">[SGW93]</a>, <a class="bibtex reference internal" href="../../../references.html#smart-hole-1996" id="id4">[SNW+96]</a>) when using this module in published work.</p>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="kn">as</span> <span class="nn">mda</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PDB_HOLE</span>
<span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">hole2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="section" id="Using-HOLE-with-a-PDB-file">
<h2>Using HOLE with a PDB file<a class="headerlink" href="#Using-HOLE-with-a-PDB-file" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.hole2.hole</span></code> is a wrapper function that calls the <a class="reference external" href="http://www.holeprogram.org">HOLE</a> program. This means you must have installed the program yourself before you can use the <code class="docutils literal notranslate"><span class="pre">hole2</span></code> module. You then need to pass the path to your <code class="docutils literal notranslate"><span class="pre">hole</span></code> executable to the functions and classes in the modules; in this example, <code class="docutils literal notranslate"><span class="pre">hole</span></code> is installed at <code class="docutils literal notranslate"><span class="pre">~/hole2/exe/hole</span></code>.</p>
<p>HOLE defines a series of points throughout the pore from which a sphere can be generated that does not overlap any atom (as defined by its van der Waals radius). (Please see (<a class="bibtex reference internal" href="../../../references.html#smart-pore-1993" id="id5">[SGW93]</a>, <a class="bibtex reference internal" href="../../../references.html#smart-hole-1996" id="id6">[SNW+96]</a>) for a complete explanation). By default, it ignores residues with the following names: “SOL”, “WAT”, “TIP”, “HOH”, “K”, “NA”, “CL”. You can change these with the <code class="docutils literal notranslate"><span class="pre">ignore_residues</span></code> keyword. Note that the residue names must have 3 characters. Wildcards <em>do not</em> work.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">hole</span></code> function allows you to specify points to begin searching at (<code class="docutils literal notranslate"><span class="pre">cpoint</span></code>) and a search direction (<code class="docutils literal notranslate"><span class="pre">cvect</span></code>), the sampling resolution (<code class="docutils literal notranslate"><span class="pre">sample</span></code>), and more. Please see the documentation for full details.</p>
<p>The PDB file here is the experimental structure of the Gramicidin A channel. Note that we pass <code class="docutils literal notranslate"><span class="pre">HOLE</span></code> a PDB file directly, without creating a <code class="docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code>.</p>
<p>We are setting a <code class="docutils literal notranslate"><span class="pre">random_seed</span></code> here so that the results in the tutorial can be reproducible. This is normally not advised.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">profiles</span> <span class="o">=</span> <span class="n">hole2</span><span class="o">.</span><span class="n">hole</span><span class="p">(</span><span class="n">PDB_HOLE</span><span class="p">,</span>
                      <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;~/hole2/exe/hole&#39;</span><span class="p">,</span>
                      <span class="n">outfile</span><span class="o">=</span><span class="s1">&#39;hole1.out&#39;</span><span class="p">,</span>
                      <span class="n">sphpdb_file</span><span class="o">=</span><span class="s1">&#39;hole1.sph&#39;</span><span class="p">,</span>
                      <span class="n">vdwradii_file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                      <span class="n">random_seed</span><span class="o">=</span><span class="mi">31415</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">outfile</span></code> and <code class="docutils literal notranslate"><span class="pre">sphpdb_file</span></code> are the names of the files that HOLE will write out. <code class="docutils literal notranslate"><span class="pre">vdwradii_file</span></code> is a file of necessary van der Waals’ radii in a HOLE-readable format. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, MDAnalysis will create a <code class="docutils literal notranslate"><span class="pre">simple2.rad</span></code> file with the built-in radii from the HOLE distribution.</p>
<p>This will create several outputs in your directory:</p>
<ul class="simple">
<li><p><strong>hole1.out</strong>: the log file for HOLE.</p></li>
<li><p><strong>hole1.sph</strong>: a PDB-like file containing the coordinates of the pore centers.</p></li>
<li><p><strong>simple2.rad</strong>: file of Van der Waals’ radii</p></li>
<li><p>**tmp*/pdb_name.pdb**: the short name of a PDB file with your structure. As <code class="docutils literal notranslate"><span class="pre">hole</span></code> is a FORTRAN77 program, it is limited in how long of a filename that it can read. Symlinking the file to the current directory can shorten the path.</p></li>
</ul>
<p>If you do not want to keep the files, set <code class="docutils literal notranslate"><span class="pre">keep_files=False</span></code>. Keep in mind that you will not be able to create a VMD surface without the sphpdb file.</p>
<p>The pore profile itself is in the <code class="docutils literal notranslate"><span class="pre">profiles1</span></code> dictionary, indexed by frame. There is only one frame in this PDB file, so it is at <code class="docutils literal notranslate"><span class="pre">profiles1[0]</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(425,)
</pre></div>
</div>
</div>
<p>Each profile is a <code class="docutils literal notranslate"><span class="pre">numpy.recarray</span></code> with the fields below as an entry for each <code class="docutils literal notranslate"><span class="pre">rxncoord</span></code>:</p>
<ul class="simple">
<li><p><strong>rxn_coord</strong>: the distance along the pore axis in angstrom</p></li>
<li><p><strong>radius</strong>: the pore radius in angstrom</p></li>
<li><p><strong>cen_line_D</strong>: distance measured along the pore centre line - the first point found is set to zero.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&#39;rxn_coord&#39;, &#39;radius&#39;, &#39;cen_line_D&#39;)
</pre></div>
</div>
</div>
<p>You can then proceed with your own analysis of the profiles.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rxn_coords</span> <span class="o">=</span> <span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rxn_coord</span>
<span class="n">pore_length</span> <span class="o">=</span> <span class="n">rxn_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">rxn_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;The pore is {} angstroms long&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pore_length</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The pore is 42.4 angstroms long
</pre></div></div>
</div>
<p>You can create a VMD surface from the <code class="docutils literal notranslate"><span class="pre">hole1.sph</span></code> output file, using the <code class="docutils literal notranslate"><span class="pre">create_vmd_surface</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hole2</span><span class="o">.</span><span class="n">create_vmd_surface</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;hole1.vmd&#39;</span><span class="p">,</span>
                         <span class="n">sphpdb</span><span class="o">=</span><span class="s1">&#39;hole1.sph&#39;</span><span class="p">,</span>
                         <span class="n">sph_process</span><span class="o">=</span><span class="s1">&#39;~/hole2/exe/sph_process&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;hole1.vmd&#39;
</pre></div>
</div>
</div>
<p>To view this, open your PDB file in VMD.</p>
<p><code class="docutils literal notranslate"><span class="pre">vmd</span> <span class="pre">tmp*/*.pdb</span></code></p>
<p>Load the output file in Extensions &gt; Tk Console:</p>
<p><code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">hole1.vmd</span></code></p>
<p>Your pore surface will be drawn as below.</p>
<center><div style="width:200px; text-align:center;"><p><img alt="sphpdb.png" src="../../../_images/sphpdb.png" /></p>
</div></center><p>MDAnalysis supports many of the options that can be customised in HOLE. For example, you can specify a starting point for the pore search within the pore with <code class="docutils literal notranslate"><span class="pre">cpoint</span></code>, and a <code class="docutils literal notranslate"><span class="pre">sample</span></code> distance (default: 0.2 angstrom) for the distance between the planes used in HOLE. Please see the <a class="reference external" href="https://www.mdanalysis.org/docs/documentation_pages/analysis/hole2.html">MDAnalysis.analysis.hole2</a> for more information.</p>
</div>
<div class="section" id="Using-HOLE-with-a-trajectory">
<h2>Using HOLE with a trajectory<a class="headerlink" href="#Using-HOLE-with-a-trajectory" title="Permalink to this headline">¶</a></h2>
<p>One of the limitations of the <code class="docutils literal notranslate"><span class="pre">hole</span></code> program is that it can only accept PDB files. In order to use other formats with <code class="docutils literal notranslate"><span class="pre">hole</span></code>, or to run <code class="docutils literal notranslate"><span class="pre">hole</span></code> on trajectories, we can use the <code class="docutils literal notranslate"><span class="pre">hole2.HoleAnalysis</span></code> class with an <code class="docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code>. While the example file below is a PDB, you can use any files to create your Universe. You can also specify that the HOLE analysis is only run on a particular group of atoms with the <code class="docutils literal notranslate"><span class="pre">select</span></code> keyword (default value: ‘protein’).</p>
<p>As with <code class="docutils literal notranslate"><span class="pre">hole()</span></code>, <code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> allows you to select a starting point for the search (<code class="docutils literal notranslate"><span class="pre">cpoint</span></code>). You can pass in a coordinate array; alternatively, you can use the center-of-geometry of your atom selection in each frame as the start.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">MULTIPDB_HOLE</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">MULTIPDB_HOLE</span><span class="p">)</span>

<span class="n">ha</span> <span class="o">=</span> <span class="n">hole2</span><span class="o">.</span><span class="n">HoleAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span>
                        <span class="n">cpoint</span><span class="o">=</span><span class="s1">&#39;center_of_geometry&#39;</span><span class="p">,</span>
                        <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;~/hole2/exe/hole&#39;</span><span class="p">)</span>
<span class="n">ha</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">random_seed</span><span class="o">=</span><span class="mi">31415</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;MDAnalysis.analysis.hole2.hole.HoleAnalysis at 0x10f3f1850&gt;
</pre></div>
</div>
</div>
<div class="section" id="Working-with-the-data">
<h3>Working with the data<a class="headerlink" href="#Working-with-the-data" title="Permalink to this headline">¶</a></h3>
<p>Again, the data is stored in <code class="docutils literal notranslate"><span class="pre">ha.profiles</span></code> as a dictionary of <code class="docutils literal notranslate"><span class="pre">numpy.recarray</span></code>s. The dictionary is indexed by frame; we can see the HOLE profile for the fourth frame below (truncated to the first 10 values).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">3</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>rec.array([(-21.01227, 15.3468 , -39.23993),
           (-20.91227, 12.63403, -34.6473 ),
           (-20.81227, 10.63723, -30.05467),
           (-20.71227,  9.58447, -27.7256 ),
           (-20.61227,  8.87309, -25.39653),
           (-20.51227,  8.56876, -23.62047),
           (-20.41227,  8.56275, -21.84441),
           (-20.31227,  8.47622, -21.74275),
           (-20.21227,  8.38983, -21.64108),
           (-20.11227,  8.30039, -21.54024)],
          dtype=[(&#39;rxn_coord&#39;, &#39;&lt;f8&#39;), (&#39;radius&#39;, &#39;&lt;f8&#39;), (&#39;cen_line_D&#39;, &#39;&lt;f8&#39;)])
</pre></div>
</div>
</div>
<p>If you want to collect each individual property, use <code class="docutils literal notranslate"><span class="pre">gather()</span></code>. Setting <code class="docutils literal notranslate"><span class="pre">flat=True</span></code> flattens the lists of <code class="docutils literal notranslate"><span class="pre">rxn_coord</span></code>, <code class="docutils literal notranslate"><span class="pre">radius</span></code>, and <code class="docutils literal notranslate"><span class="pre">cen_line_D</span></code>, in order. You can select which frames you want by passing an iterable of frame indices to <code class="docutils literal notranslate"><span class="pre">frames</span></code>. <code class="docutils literal notranslate"><span class="pre">frames=None</span></code> returns all frames.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gathered</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">gather</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">gathered</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;rxn_coord&#39;, &#39;radius&#39;, &#39;cen_line_D&#39;])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gathered</span><span class="p">[</span><span class="s1">&#39;rxn_coord&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
11
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">flat</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flat</span><span class="p">[</span><span class="s1">&#39;rxn_coord&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3983
</pre></div></div>
</div>
<p>You may also want to collect the radii in bins of <code class="docutils literal notranslate"><span class="pre">rxn_coord</span></code> for the entire trajectory with the <code class="docutils literal notranslate"><span class="pre">bin_radii()</span></code> function. <code class="docutils literal notranslate"><span class="pre">range</span></code> should be a tuple of the lower and upper edges of the first and last bins, respectively. If <code class="docutils literal notranslate"><span class="pre">range=None</span></code>, the minimum and maximum values of <code class="docutils literal notranslate"><span class="pre">rxn_coord</span></code> are used.</p>
<p><code class="docutils literal notranslate"><span class="pre">bins</span></code> can be either an iterable of (lower, upper) edges (in which case <code class="docutils literal notranslate"><span class="pre">range</span></code> is ignored), or a number specifying how many bins to create with <code class="docutils literal notranslate"><span class="pre">range</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">radii</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">bin_radii</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The closely related <code class="docutils literal notranslate"><span class="pre">histogram_radii()</span></code> function takes the same arguments as <code class="docutils literal notranslate"><span class="pre">bin_radii()</span></code> to group the pore radii, but allows you to specify an aggregating function with <code class="docutils literal notranslate"><span class="pre">aggregator</span></code> (default: <code class="docutils literal notranslate"><span class="pre">np.mean</span></code>) that will be applied to each array of radii. The arguments for this function, and returned values, are analogous to those for <code class="docutils literal notranslate"><span class="pre">np.histogram</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">means</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">histogram_radii</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                  <span class="n">aggregator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We can use this to plot the mean radii of the pore over the trajectory. (You can also accomplish this with the <code class="docutils literal notranslate"><span class="pre">plot_mean_profile()</span></code> function shown below, by setting <code class="docutils literal notranslate"><span class="pre">n_std=0</span></code>.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">midpoints</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">midpoints</span><span class="p">,</span> <span class="n">means</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Mean HOLE radius $R$ ($\AA$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pore coordinate $\zeta$ ($\AA$)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_29_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_29_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> also has the <code class="docutils literal notranslate"><span class="pre">min_radius()</span></code> function, which will return the minimum radius in angstrom for each frame. The resulting array has the shape (#n_frames, 2).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_radii</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">min_radius</span><span class="p">()</span>
<span class="n">min_radii</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([[ 0.     , -0.23655],
       [ 1.     ,  1.56731],
       [ 2.     ,  1.53329],
       [ 3.     ,  1.42503],
       [ 4.     ,  1.2426 ],
       [ 5.     ,  1.19813],
       [ 6.     ,  1.29624],
       [ 7.     ,  1.43776],
       [ 8.     ,  1.51123],
       [ 9.     ,  0.87855],
       [10.     ,  0.99659]])
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">min_radii</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">min_radii</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Minimum HOLE radius $R$ ($\AA$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frame&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_32_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_32_0.png" />
</div>
</div>
</div>
<div class="section" id="Visualising-the-VMD-surface">
<h3>Visualising the VMD surface<a class="headerlink" href="#Visualising-the-VMD-surface" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">create_vmd_surface()</span></code> method is built into the <code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> class. It writes a VMD file that changes the pore surface for each frame in VMD. Again, load your file and source the file in the Tk Console:</p>
<p><code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">holeanalysis.vmd</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">create_vmd_surface</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;holeanalysis.vmd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;holeanalysis.vmd&#39;
</pre></div>
</div>
</div>
<center><div style="width: 300px"><p><img alt="hole.gif" src="../../../_images/pore.gif" /></p>
</div></center></div>
<div class="section" id="Plotting">
<h3>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> has several convenience methods for plotting. <code class="docutils literal notranslate"><span class="pre">plot()</span></code> plots the HOLE radius over each pore coordinate, differentiating each frame with colour.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_39_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_39_0.png" />
</div>
</div>
<p>You can choose to plot specific frames, or specify colours or a colour map. Please see the documentation for a full description of arguments.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_41_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_41_0.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">plot3D()</span></code> function separates each frame onto its own axis in a 3D plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot3D</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_43_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_43_0.png" />
</div>
</div>
<p>You can choose to plot only the part of each pore lower than a certain radius by setting <code class="docutils literal notranslate"><span class="pre">r_max</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">r_max</span><span class="o">=</span><span class="mf">2.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_45_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_45_0.png" />
</div>
</div>
<p>You can also plot the mean and standard deviation of the pore radius over the pore coordinate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot_mean_profile</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># how much to chunk rxn_coord</span>
                     <span class="n">n_std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># how many standard deviations from mean</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>  <span class="c1"># color of plot</span>
                     <span class="n">fill_alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>  <span class="c1"># opacity of standard deviation</span>
                     <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_47_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_47_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Ordering-HOLE-profiles-with-an-order-parameter">
<h2>Ordering HOLE profiles with an order parameter<a class="headerlink" href="#Ordering-HOLE-profiles-with-an-order-parameter" title="Permalink to this headline">¶</a></h2>
<p>If you are interested in the HOLE profiles over an order parameter, you can directly pass that into the analysis after it is run. Below, we use an order parameter of RMSD from a reference structure.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>Please cite (<a class="bibtex reference internal" href="../../../references.html#stelzl-flexible-2014" id="id7">[SFSB14]</a>) when using the <code class="docutils literal notranslate"><span class="pre">over_order_parameters</span></code> functionality.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">MDAnalysis.analysis</span> <span class="kn">import</span> <span class="n">rms</span>

<span class="n">ref</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PDB_HOLE</span><span class="p">)</span>
<span class="n">rmsd</span> <span class="o">=</span> <span class="n">rms</span><span class="o">.</span><span class="n">RMSD</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">rmsd_values</span> <span class="o">=</span> <span class="n">rmsd</span><span class="o">.</span><span class="n">rmsd</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">rmsd_values</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([6.10501252e+00, 4.88398472e+00, 3.66303524e+00, 2.44202454e+00,
       1.22100521e+00, 1.67285541e-07, 1.22100162e+00, 2.44202456e+00,
       3.66303410e+00, 4.88398478e+00, 6.10502262e+00])
</pre></div>
</div>
</div>
<p>You can pass this in as <code class="docutils literal notranslate"><span class="pre">order_parameter</span></code>. The resulting <code class="docutils literal notranslate"><span class="pre">profiles</span></code> dictionary will have your order parameters as keys. <strong>You should be careful with this if your order parameter has repeated values, as duplicate keys are not possible; each duplicate key just overwrites the previous value.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">op_profiles</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">over_order_parameters</span><span class="p">(</span><span class="n">rmsd_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can see here that the dictionary does not order the entries by the order parameter. If you iterate over the dictionary, it will return each (key, value) pair in sorted key order.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">order_parameter</span><span class="p">,</span> <span class="n">profile</span> <span class="ow">in</span> <span class="n">op_profiles</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">order_parameter</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">profile</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.6728554140225013e-07 543
1.2210016190719406 389
1.2210052104208637 511
2.4420245432434005 419
2.4420245634673616 399
3.6630340992950225 379
3.663035235691455 443
4.883984723991125 407
4.883984778674993 149
6.105012519709198 205
6.105022620520391 139
</pre></div></div>
</div>
<p>You can also select specific frames for the new profiles.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">op_profiles</span> <span class="o">=</span> <span class="n">ha</span><span class="o">.</span><span class="n">over_order_parameters</span><span class="p">(</span><span class="n">rmsd_values</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="n">op_profiles</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>dict_keys([1.2210052104208637, 4.883984778674993, 6.105012519709198])
</pre></div>
</div>
</div>
<div class="section" id="Plotting">
<h3>Plotting<a class="headerlink" href="#Plotting" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> also provides convenience functions for plotting over order parameters. Unlike <code class="docutils literal notranslate"><span class="pre">plot()</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_order_parameters()</span></code> requires an <code class="docutils literal notranslate"><span class="pre">aggregator</span></code> function that reduces an array of radii to a singular value. The default function is <code class="docutils literal notranslate"><span class="pre">min()</span></code>. You can also pass in functions such as <code class="docutils literal notranslate"><span class="pre">max()</span></code> or <code class="docutils literal notranslate"><span class="pre">np.mean()</span></code>, or define your own function to operate on an array and return a vlue.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot_order_parameters</span><span class="p">(</span><span class="n">rmsd_values</span><span class="p">,</span>
                         <span class="n">aggregator</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span>
                         <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;RMSD to reference ($\AA$)&#39;</span><span class="p">,</span>
                         <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Minimum HOLE pore radius $r$ ($\AA$)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_58_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_58_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">plot3D_order_parameters()</span></code> functions in a similar way to <code class="docutils literal notranslate"><span class="pre">plot3D()</span></code>, although you need to pass in the order parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">plot3D_order_parameters</span><span class="p">(</span><span class="n">rmsd_values</span><span class="p">,</span>
                           <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;RMSD to reference ($\AA$)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_60_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_60_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Deleting-HOLE-files">
<h2>Deleting HOLE files<a class="headerlink" href="#Deleting-HOLE-files" title="Permalink to this headline">¶</a></h2>
<p>The HOLE program and related MDAnalysis code write a number of files out. Both the <code class="docutils literal notranslate"><span class="pre">hole()</span></code> function and <code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> class contain ways to easily remove these files.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">hole()</span></code>, pass in <code class="docutils literal notranslate"><span class="pre">keep_files=False</span></code> to delete HOLE files as soon as the analysis is done. However, this will also remove the sphpdb file required to create a VMD surface from the analysis. If you need to write a VMD surface file, use the <code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> class instead.</p>
<p>You can track the created files at the <code class="docutils literal notranslate"><span class="pre">tmp_files</span></code> attribute.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">tmp_files</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;simple2.rad&#39;,
 &#39;hole000.out&#39;,
 &#39;hole000.sph&#39;,
 &#39;hole001.out&#39;,
 &#39;hole001.sph&#39;,
 &#39;hole002.out&#39;,
 &#39;hole002.sph&#39;,
 &#39;hole003.out&#39;,
 &#39;hole003.sph&#39;,
 &#39;hole004.out&#39;,
 &#39;hole004.sph&#39;,
 &#39;hole005.out&#39;,
 &#39;hole005.sph&#39;,
 &#39;hole006.out&#39;,
 &#39;hole006.sph&#39;,
 &#39;hole007.out&#39;,
 &#39;hole007.sph&#39;,
 &#39;hole008.out&#39;,
 &#39;hole008.sph&#39;,
 &#39;hole009.out&#39;,
 &#39;hole009.sph&#39;,
 &#39;hole010.out&#39;,
 &#39;hole010.sph&#39;]
</pre></div>
</div>
</div>
<p>The built-in method <code class="docutils literal notranslate"><span class="pre">delete_temporary_files()</span></code> will remove these.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">delete_temporary_files</span><span class="p">()</span>
<span class="n">ha</span><span class="o">.</span><span class="n">tmp_files</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[]
</pre></div>
</div>
</div>
<p>Alternatively, you can use <code class="docutils literal notranslate"><span class="pre">HoleAnalysis</span></code> as a context manager. When you exit the block, the temporary files will be deleted automatically.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">hole2</span><span class="o">.</span><span class="n">HoleAnalysis</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">executable</span><span class="o">=</span><span class="s1">&#39;~/hole2/exe/hole&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ha2</span><span class="p">:</span>
    <span class="n">ha2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">ha2</span><span class="o">.</span><span class="n">create_vmd_surface</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;holeanalysis.vmd&#39;</span><span class="p">)</span>
    <span class="n">ha2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../_images/examples_analysis_polymers_and_membranes_hole2_66_0.png" src="../../../_images/examples_analysis_polymers_and_membranes_hole2_66_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ha</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">radius</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>20.0962
</pre></div>
</div>
</div>
</div>
<div class="section" id="References">
<h2>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h2>
<p>[1] Richard J. Gowers, Max Linke, Jonathan Barnoud, Tyler J. E. Reddy, Manuel N. Melo, Sean L. Seyler, Jan Domański, David L. Dotson, Sébastien Buchoux, Ian M. Kenney, and Oliver Beckstein. MDAnalysis: A Python Package for the Rapid Analysis of Molecular Dynamics Simulations. Proceedings of the 15th Python in Science Conference, pages 98–105, 2016. 00152. URL: <a class="reference external" href="https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html">https://conference.scipy.org/proceedings/scipy2016/oliver_beckstein.html</a>, doi:10.25080/Majora-629e541a-00e.</p>
<p>[2] Naveen Michaud-Agrawal, Elizabeth J. Denning, Thomas B. Woolf, and Oliver Beckstein. MDAnalysis: A toolkit for the analysis of molecular dynamics simulations. Journal of Computational Chemistry, 32(10):2319–2327, July 2011. 00778. URL: <a class="reference external" href="http://doi.wiley.com/10.1002/jcc.21787">http://doi.wiley.com/10.1002/jcc.21787</a>, doi:10.1002/jcc.21787.</p>
<p>[3] O S Smart, J M Goodfellow, and B A Wallace. The pore dimensions of gramicidin A. Biophysical Journal, 65(6):2455–2460, December 1993. 00522. URL: <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1225986/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1225986/</a>, doi:10.1016/S0006-3495(93)81293-1.</p>
<p>[4] O. S. Smart, J. G. Neduvelil, X. Wang, B. A. Wallace, and M. S. Sansom. HOLE: a program for the analysis of the pore dimensions of ion channel structural models. Journal of Molecular Graphics, 14(6):354–360, 376, December 1996. 00935. doi:10.1016/s0263-7855(97)00009-x.</p>
<p>[5] Lukas S. Stelzl, Philip W. Fowler, Mark S. P. Sansom, and Oliver Beckstein. Flexible gates generate occluded intermediates in the transport cycle of LacY. Journal of Molecular Biology, 426(3):735–751, February 2014. 00000. URL: <a class="reference external" href="https://asu.pure.elsevier.com/en/publications/flexible-gates-generate-occluded-intermediates-in-the-transport-c">https://asu.pure.elsevier.com/en/publications/flexible-gates-generate-occluded-intermediates-in-the-transport-c</a>, doi:10.1016/j.jmb.2013.10.024.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../volumetric/README.html" class="btn btn-neutral float-right" title="Volumetric analyses" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="hole.html" class="btn btn-neutral float-left" title="Analysing pore dimensions (deprecated)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Lily Wang, Richard J Gowers, Oliver Beckstein

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>